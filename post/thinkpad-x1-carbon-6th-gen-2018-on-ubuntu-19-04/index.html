<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8" />

  
  <title>Thinkpad X1 Carbon 6th Gen (2018) on Ubuntu 19.04</title>

  
  
  <link href="//cdn.jsdelivr.net" rel="dns-prefetch">
  <link href="//cdnjs.cloudflare.com" rel="dns-prefetch">
  
  <link href="//at.alicdn.com" rel="dns-prefetch">
  
  <link href="//fonts.googleapis.com" rel="dns-prefetch">
  <link href="//fonts.gstatic.com" rel="dns-prefetch">
  
  
  
  
  

  

  
  
  <meta name="description" content="This is my recipe to install Ubuntu 19.04 Disco Dingo on the Lenovo Thinkpad X1 Carbon 6th gen (2018). This guide should serve you as well for Ubuntu 18.04 LTS, but the newer kernel and GNOME on 19.04 offer better power management and HiDPI support.
The X1 Carbon is an excellent laptop for developers, and even though its Linux support is good, getting it to work perfectly still requires some tinkering.">

  
  
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@gohugoio">
    <meta name="twitter:title" content="Thinkpad X1 Carbon 6th Gen (2018) on Ubuntu 19.04">
    <meta name="twitter:description" content="This is my recipe to install Ubuntu 19.04 Disco Dingo on the Lenovo Thinkpad X1 Carbon 6th gen (2018). This guide should serve you as well for Ubuntu 18.04 LTS, but the newer kernel and GNOME on 19.04 offer better power management and HiDPI support.
The X1 Carbon is an excellent laptop for developers, and even though its Linux support is good, getting it to work perfectly still requires some tinkering.">
    <meta name="twitter:image" content="/images/avatar.jpeg">
  

  
  <meta property="og:type" content="article">
  <meta property="og:title" content="Thinkpad X1 Carbon 6th Gen (2018) on Ubuntu 19.04">
  <meta property="og:description" content="This is my recipe to install Ubuntu 19.04 Disco Dingo on the Lenovo Thinkpad X1 Carbon 6th gen (2018). This guide should serve you as well for Ubuntu 18.04 LTS, but the newer kernel and GNOME on 19.04 offer better power management and HiDPI support.
The X1 Carbon is an excellent laptop for developers, and even though its Linux support is good, getting it to work perfectly still requires some tinkering.">
  <meta property="og:url" content="/post/thinkpad-x1-carbon-6th-gen-2018-on-ubuntu-19-04/">
  <meta property="og:image" content="/images/avatar.jpeg">




<meta name="generator" content="Hugo 0.55.6">


<link rel="canonical" href="/post/thinkpad-x1-carbon-6th-gen-2018-on-ubuntu-19-04/">

<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="format-detection" content="telephone=no,email=no,adress=no">
<meta http-equiv="Cache-Control" content="no-transform">


<meta name="robots" content="index,follow">
<meta name="referrer" content="origin-when-cross-origin">







<meta name="theme-color" content="#02b875">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="Octavi Font">
<meta name="msapplication-tooltip" content="Octavi Font">
<meta name='msapplication-navbutton-color' content="#02b875">
<meta name="msapplication-TileColor" content="#02b875">
<meta name="msapplication-TileImage" content="/icons/icon-144x144.png">
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32x32.png">
<link rel="icon" sizes="192x192" href="/icons/icon-192x192.png">
<link rel="apple-touch-icon" href="/icons/icon-152x152.png">
<link rel="manifest" href="/manifest.json">


<link rel="preload" href="/styles/main-rendered.min.css" as="style">

<link rel="preload" href="/styles/custom.min.css" as="style">
<link rel="preload" href="https://fonts.googleapis.com/css?family=Lobster" as="style">
<link rel="preload" href="/images/avatar.jpeg" as="image">
<link rel="preload" href="/images/grey-prism.svg" as="image">


<style>
  body {
    background: rgb(244, 243, 241) url('/images/grey-prism.svg') repeat fixed;
  }
</style>
<link rel="stylesheet" href="/styles/main-rendered.min.css">

<link rel="stylesheet" href="/styles/custom.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster">



<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.2/dist/medium-zoom.min.js"></script>




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/video.js@7.3.0/dist/video-js.min.css">



  
  
<!--[if lte IE 8]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/videojs-ie8@1.1.2/dist/videojs-ie8.min.js"></script>
<![endif]-->

<!--[if lte IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/eligrey-classlist-js-polyfill@1.2.20180112/classList.min.js"></script>
<![endif]-->


</head>
  <body>
    <div class="suspension">
      <a role="button" aria-label="Go to top" title="Go to top" class="to-top is-hide"><span class="icon icon-up" aria-hidden="true"></span></a>
      
        
      
    </div>
    
    
  <header class="site-header">
  <img class="avatar" src="/images/avatar.jpeg" alt="Avatar">
  
  <h2 class="title">Octavi Font</h2>
  
  <p class="subtitle">~ AI for healthcare - Consulting ~</p>
  <button class="menu-toggle" type="button" aria-label="Main Menu" aria-expanded="false" tab-index="0">
    <span class="icon icon-menu" aria-hidden="true"></span>
  </button>

  <nav class="site-menu collapsed">
    <h2 class="offscreen">Main Menu</h2>
    <ul class="menu-list">
      
      
      
      
        <li class="menu-item
          
          
           is-active">
          <a href="/">Blog</a>
        </li>
      
        <li class="menu-item
          
          
          ">
          <a href="/projects/">Projects</a>
        </li>
      
        <li class="menu-item
          
          
          ">
          <a href="/about/">About</a>
        </li>
      
    </ul>
  </nav>
  <nav class="social-menu collapsed">
    <h2 class="offscreen">Social Networks</h2>
    <ul class="social-list"><li class="social-item">
          <a href="mailto:octavi@octavifs.me" title="Email" aria-label="Email">
            <span class="icon icon-email" aria-hidden="true"></span>
          </a>
        </li><li class="social-item">
          <a href="//github.com/octavifs" rel="me" title="GitHub" aria-label="GitHub">
	    <span class="icon icon-github" aria-hidden="true"></span>
          </a>
        </li><li class="social-item">
          <a href="//www.linkedin.com/in/octavifs" rel="me" title="LinkedIn" aria-label="LinkedIn">
            <span class="icon icon-linkedin" aria-hidden="true"></span>
          </a>
        </li></ul>
  </nav>
</header>

  <section class="main post-detail">
    <header class="post-header">
      <h1 class="post-title">Thinkpad X1 Carbon 6th Gen (2018) on Ubuntu 19.04</h1>
      <p class="post-meta">@ · May 3, 2019 · 3 min read</p>
    </header>
    <article class="post-content">

<p>This is my recipe to install Ubuntu 19.04 Disco Dingo on the Lenovo Thinkpad X1 Carbon 6th gen (2018). This guide should serve you as well for Ubuntu 18.04 LTS, but the newer kernel and GNOME on 19.04 offer better power management and HiDPI support.</p>

<p>The X1 Carbon is an excellent laptop for developers, and even though its Linux support is good, getting it to work perfectly still requires some tinkering. This topic has been covered already, but there&rsquo;ve been improvements in hardware support over the last year that are not reflected on older articles. Hopefully this will serve as an up-to-date, streamlined version on how to set it up after installing Ubuntu.</p>

<p><img src="/media/post/thinkpad-x1-carbon-6th-gen-2018-on-ubuntu-19-04/thinkpad_x1c_banner.jpg" alt="Thinkpad X1 Carbon 6th gen (2018)" /></p>

<p><em>Mugshot: The culprit behind this article, suspended</em></p>

<p>This setup should leave the laptop fully working, except for the fingerprint reader, for which there are no available drivers. Everything else is 100% functional.</p>

<h2 id="bios-config-changes">BIOS config changes</h2>

<p>We&rsquo;ll need to perform some changes on the BIOS to get the most of our Thinkpad. It&rsquo;s better to do so before installing Ubuntu itself, since secure boot needs to be disabled to perform the installation anyway. Here&rsquo;s the list:</p>

<pre><code># Disable secure boot to install Ubuntu
Security &gt; Secure Boot: Disable

# Set Sleep State to Linux to enable S3 suspend mode
# This should be available on firmware version &gt;= 1.30
Config &gt; Power &gt; Sleep State: Set to Linux

# Disable uneeded peripherals to save a few watts (optional)
Security &gt; I/O Port Access &gt; Wireless WAN:       Disable
                           &gt; Memory Card Slot:   Disable
                           &gt; Fingerprint Reader: Disable
</code></pre>

<h2 id="battery-life">Battery Life</h2>

<p>After Ubuntu&rsquo;s install, you can add <code>tlp</code> to improve power management:</p>

<pre><code>sudo apt install tlp tlp-rdw acpi-call-dkms tp-smapi-dkms acpi-call-dkms
</code></pre>

<p>If you are keen on tracking the wattage your laptop is consuming, you should also try these tools:</p>

<pre><code>sudo apt install powertop s-tui
</code></pre>

<p><img src="/media/post/thinkpad-x1-carbon-6th-gen-2018-on-ubuntu-19-04/stui.png" alt="s-tui monitoring power usage and temperature" /></p>

<p><em>s-tui monitoring power usage and temperature</em></p>

<h2 id="cpu-throttling">CPU Throttling</h2>

<p>X1 Carbon under Linux throttles the CPU below its TDP under load, robbing you of the extra <em>oomph</em> you paid top dollar for. Thankfully there is a <a href="https://github.com/erpalma/throttled">fix for that</a>. You&rsquo;ll have to install the following:</p>

<pre><code>sudo apt install git build-essential python3-dev libdbus-glib-1-dev libgirepository1.0-dev libcairo2-dev python3-venv python3-wheel
git clone https://github.com/erpalma/lenovo-throttling-fix.git
sudo ./lenovo-throttling-fix/install.sh
</code></pre>

<p>Also, you&rsquo;ll need to disable <em>thermald</em>, as it conflicts with the fix:</p>

<pre><code>sudo systemctl stop thermald.service
sudo systemctl disable thermald.service
sudo systemctl mask thermald.service
</code></pre>

<p><em>lenovo-throttling-fix</em> also supports undervolting, which helps bringing temperatures down, improve battery life and increase performance. It also <strong>DOES</strong> make the system unstable, when performed too aggressively. The project <a href="https://github.com/erpalma/throttled#Configuration">README</a> has extensive documentation on how to set it up, if you are so inclined.</p>

<h2 id="suspend">Suspend</h2>

<p>Works out of the box once the BIOS <em>Sleep State</em> has been fixed.</p>

<h2 id="hidpi-support">HiDPI support</h2>

<p>If you have the WQHD screen and you find GNOME&rsquo;s 2x integer scaling too large for you, I&rsquo;ve got an article dedicated to <a href="/post/hidpi-support-on-ubuntu-19-04/">fractional scaling HiDPI support on Ubuntu 19.04</a>.</p>

<p>TLDR: It works well, despite not being fully integrated in GNOME.</p>

<h2 id="additional-resources">Additional resources</h2>

<ul>
<li><a href="https://wiki.archlinux.org/index.php/Lenovo_ThinkPad_X1_Carbon_(Gen_6)">Arch wiki</a></li>
<li><a href="https://mensfeld.pl/2018/05/lenovo-thinkpad-x1-carbon-6th-gen-2018-ubuntu-18-04-tweaks">Thinkpad X1C on Ubuntu 18.04 (mensfeld)</a></li>
<li><a href="https://medium.com/@hkdb/ubuntu-18-04-on-lenovo-x1-carbon-6g-d99d5667d4d5">Thinkpad X1C on Ubuntu 18.04 (@hkdb)</a></li>
<li><a href="https://github.com/erpalma/throttled">Lenovo Throttling fix</a></li>
</ul>
</article>
    <footer class="post-footer">
      
      <p class="post-copyright">
        
      </p>
    </footer>
    
      
    
  </section>
  
<footer class="site-footer">
  <p>© 2017-2019 Octavi Font</p>
  <p>Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> with theme <a href="https://github.com/laozhu/hugo-nuo" target="_blank" rel="noopener">Nuo</a>.</p>
  
</footer>


<script src="https://cdn.jsdelivr.net/npm/smooth-scroll@15.0.0/dist/smooth-scroll.min.js"></script>



<script async src="https://cdn.jsdelivr.net/npm/video.js@7.3.0/dist/video.min.js"></script>




<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    },
  });
</script>
<script type="text/x-mathjax-config">
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script>



<script src="/scripts/index.min.js"></script>

<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('\/service-worker.js').then(function() {
      console.log('[ServiceWorker] Registered');
    });
  }
</script>








  </body>
</html>
